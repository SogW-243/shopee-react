import{t as se,j as e,a as He,g as Le,r as x,u as ze,J as me,b as Ee,K as Ie,z as U,s as J,c as K,d as ge,e as Te,m as fe,M as $e,N as de,O as Ne,Q as ke,v as Oe,x as Be,B as P,C as De,P as ue,G as ne,T as h,w as pe,A as We}from"./index-DAM9OwgT.js";import{u as Qe}from"./useMutation-x7wGYxWg.js";import{Q as Ue}from"./QuantityInput-r1lCIMkE.js";import{u as Ge}from"./TextField-BndjYSyv.js";import{S as qe}from"./Snackbar-DYtLVi8F.js";import"./Grow-DsunroZE.js";const Xe={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},Ke=se(e.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})),Je=se(e.jsx("path",{d:"M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"}));function Ye(t){return Le("MuiRating",t)}const Q=He("MuiRating",["root","sizeSmall","sizeMedium","sizeLarge","readOnly","disabled","focusVisible","visuallyHidden","pristine","label","labelEmptyValueActive","icon","iconEmpty","iconFilled","iconHover","iconFocus","iconActive","decimal"]);function _e(t){const o=t.toString().split(".")[1];return o?o.length:0}function ie(t,o){if(t==null)return t;const a=Math.round(t/o)*o;return Number(a.toFixed(_e(o)))}const Ze=t=>{const{classes:o,size:a,readOnly:i,disabled:m,emptyValueFocused:y,focusVisible:F}=t,v={root:["root",`size${ge(a)}`,m&&"disabled",F&&"focusVisible",i&&"readOnly"],label:["label","pristine"],labelEmptyValue:[y&&"labelEmptyValueActive"],icon:["icon"],iconEmpty:["iconEmpty"],iconFilled:["iconFilled"],iconHover:["iconHover"],iconFocus:["iconFocus"],iconActive:["iconActive"],decimal:["decimal"],visuallyHidden:["visuallyHidden"]};return Te(v,Ye,o)},et=J("span",{name:"MuiRating",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:a}=t;return[{[`& .${Q.visuallyHidden}`]:o.visuallyHidden},o.root,o[`size${ge(a.size)}`],a.readOnly&&o.readOnly]}})(fe(({theme:t})=>({display:"inline-flex",position:"relative",fontSize:t.typography.pxToRem(24),color:"#faaf00",cursor:"pointer",textAlign:"left",width:"min-content",WebkitTapHighlightColor:"transparent",[`&.${Q.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${Q.focusVisible} .${Q.iconActive}`]:{outline:"1px solid #999"},[`& .${Q.visuallyHidden}`]:Xe,variants:[{props:{size:"small"},style:{fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{fontSize:t.typography.pxToRem(30)}},{props:({ownerState:o})=>o.readOnly,style:{pointerEvents:"none"}}]}))),xe=J("label",{name:"MuiRating",slot:"Label",overridesResolver:({ownerState:t},o)=>[o.label,t.emptyValueFocused&&o.labelEmptyValueActive]})({cursor:"inherit",variants:[{props:({ownerState:t})=>t.emptyValueFocused,style:{top:0,bottom:0,position:"absolute",outline:"1px solid #999",width:"100%"}}]}),tt=J("span",{name:"MuiRating",slot:"Icon",overridesResolver:(t,o)=>{const{ownerState:a}=t;return[o.icon,a.iconEmpty&&o.iconEmpty,a.iconFilled&&o.iconFilled,a.iconHover&&o.iconHover,a.iconFocus&&o.iconFocus,a.iconActive&&o.iconActive]}})(fe(({theme:t})=>({display:"flex",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest}),pointerEvents:"none",variants:[{props:({ownerState:o})=>o.iconActive,style:{transform:"scale(1.2)"}},{props:({ownerState:o})=>o.iconEmpty,style:{color:(t.vars||t).palette.action.disabled}}]}))),ot=J("span",{name:"MuiRating",slot:"Decimal",shouldForwardProp:t=>$e(t)&&t!=="iconActive",overridesResolver:(t,o)=>{const{iconActive:a}=t;return[o.decimal,a&&o.iconActive]}})({position:"relative",variants:[{props:({iconActive:t})=>t,style:{transform:"scale(1.2)"}}]});function nt(t){const{value:o,...a}=t;return e.jsx("span",{...a})}function he(t){const{classes:o,disabled:a,emptyIcon:i,focus:m,getLabelText:y,highlightSelectedOnly:F,hover:v,icon:M,IconContainerComponent:E,isActive:b,itemValue:p,labelProps:V,name:d,onBlur:l,onChange:c,onClick:n,onFocus:j,readOnly:A,ownerState:S,ratingValue:u,ratingValueRounded:H,slots:Y={},slotProps:_={}}=t,L=F?p===u:p<=u,O=p<=v,G=p<=m,B=p===H,q=`${d}-${me()}`,D={slots:Y,slotProps:_},[I,Z]=U("icon",{elementType:tt,className:K(o.icon,L?o.iconFilled:o.iconEmpty,O&&o.iconHover,G&&o.iconFocus,b&&o.iconActive),externalForwardedProps:D,ownerState:{...S,iconEmpty:!L,iconFilled:L,iconHover:O,iconFocus:G,iconActive:b},additionalProps:{value:p},internalForwardedProps:{as:E}}),[g,T]=U("label",{elementType:xe,externalForwardedProps:D,ownerState:{...S,emptyValueFocused:void 0},additionalProps:{style:V?.style,htmlFor:q}}),C=e.jsx(I,{...Z,children:i&&!L?i:M});return A?e.jsx("span",{...V,children:C}):e.jsxs(x.Fragment,{children:[e.jsxs(g,{...T,children:[C,e.jsx("span",{className:o.visuallyHidden,children:y(p)})]}),e.jsx("input",{className:o.visuallyHidden,onFocus:j,onBlur:l,onChange:c,onClick:n,disabled:a,value:p,id:q,type:"radio",name:d,checked:B})]})}const it=e.jsx(Ke,{fontSize:"inherit"}),st=e.jsx(Je,{fontSize:"inherit"});function at(t){return`${t||"0"} Star${t!==1?"s":""}`}const rt=x.forwardRef(function(o,a){const i=ze({name:"MuiRating",props:o}),{component:m="span",className:y,defaultValue:F=null,disabled:v=!1,emptyIcon:M=st,emptyLabelText:E="Empty",getLabelText:b=at,highlightSelectedOnly:p=!1,icon:V=it,IconContainerComponent:d=nt,max:l=5,name:c,onChange:n,onChangeActive:j,onMouseLeave:A,onMouseMove:S,precision:u=1,readOnly:H=!1,size:Y="medium",value:_,slots:L={},slotProps:O={},...G}=i,B=me(c),[q,D]=Ge({controlled:_,default:F,name:"Rating"}),I=ie(q,u),Z=Ee(),[{hover:g,focus:T},C]=x.useState({hover:-1,focus:-1});let $=I;g!==-1&&($=g),T!==-1&&($=T);const[ye,ee]=x.useState(!1),ae=x.useRef(),ve=Ie(ae,a),be=s=>{S&&S(s);const r=ae.current,{right:f,left:X,width:N}=r.getBoundingClientRect();let k;Z?k=(f-s.clientX)/N:k=(s.clientX-X)/N;let w=ie(l*k+u/2,u);w=Ne(w,u,l),C(z=>z.hover===w&&z.focus===w?z:{hover:w,focus:w}),ee(!1),j&&g!==w&&j(s,w)},je=s=>{A&&A(s);const r=-1;C({hover:r,focus:r}),j&&g!==r&&j(s,r)},re=s=>{let r=s.target.value===""?null:parseFloat(s.target.value);g!==-1&&(r=g),D(r),n&&n(s,r)},Se=s=>{s.clientX===0&&s.clientY===0||(C({hover:-1,focus:-1}),D(null),n&&parseFloat(s.target.value)===I&&n(s,null))},we=s=>{de(s.target)&&ee(!0);const r=parseFloat(s.target.value);C(f=>({hover:f.hover,focus:r}))},Pe=s=>{if(g!==-1)return;de(s.target)||ee(!1);const r=-1;C(f=>({hover:f.hover,focus:r}))},[Fe,le]=x.useState(!1),W={...i,component:m,defaultValue:F,disabled:v,emptyIcon:M,emptyLabelText:E,emptyValueFocused:Fe,focusVisible:ye,getLabelText:b,icon:V,IconContainerComponent:d,max:l,precision:u,readOnly:H,size:Y},R=Ze(W),te={slots:L,slotProps:O},[Ce,Re]=U("root",{ref:ve,className:K(R.root,y),elementType:et,externalForwardedProps:{...te,...G,component:m},getSlotProps:s=>({...s,onMouseMove:r=>{be(r),s.onMouseMove?.(r)},onMouseLeave:r=>{je(r),s.onMouseLeave?.(r)}}),ownerState:W,additionalProps:{role:H?"img":null,"aria-label":H?b($):null}}),[Me,Ve]=U("label",{className:K(R.label,R.labelEmptyValue),elementType:xe,externalForwardedProps:te,ownerState:W}),[Ae,ce]=U("decimal",{className:R.decimal,elementType:ot,externalForwardedProps:te,ownerState:W});return e.jsxs(Ce,{...Re,children:[Array.from(new Array(l)).map((s,r)=>{const f=r+1,X={classes:R,disabled:v,emptyIcon:M,focus:T,getLabelText:b,highlightSelectedOnly:p,hover:g,icon:V,IconContainerComponent:d,name:B,onBlur:Pe,onChange:re,onClick:Se,onFocus:we,ratingValue:$,ratingValueRounded:I,readOnly:H,ownerState:W,slots:L,slotProps:O},N=f===Math.ceil($)&&(g!==-1||T!==-1);if(u<1){const k=Array.from(new Array(1/u));return x.createElement(Ae,{...ce,key:f,className:K(ce.className,N&&R.iconActive),iconActive:N},k.map((w,z)=>{const oe=ie(f-1+(z+1)*u,u);return e.jsx(he,{...X,isActive:!1,itemValue:oe,labelProps:{style:k.length-1===z?{}:{width:oe===$?`${(z+1)*u*100}%`:"0%",overflow:"hidden",position:"absolute"}}},oe)}))}return e.jsx(he,{...X,isActive:N,itemValue:f},f)}),!H&&!v&&e.jsxs(Me,{...Ve,children:[e.jsx("input",{className:R.visuallyHidden,value:"",id:`${B}-empty`,type:"radio",name:B,checked:I==null,onFocus:()=>le(!0),onBlur:()=>le(!1),onChange:re}),e.jsx("span",{className:R.visuallyHidden,children:E})]})]})}),lt=se(e.jsx("path",{d:"M11 9h2V6h3V4h-3V1h-2v3H8v2h3zm-4 9c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2m10 0c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2m-9.83-3.25.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.86-7.01L19.42 4h-.01l-1.1 2-2.76 5H8.53l-.13-.27L6.16 6l-.95-2-.94-2H1v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.13 0-.25-.11-.25-.25"}));function gt(){const{id:t}=ke(),o=Oe(),a=Be(),[i,m]=x.useState(null),[y,F]=x.useState(1),[v,M]=x.useState(!1),E=d=>d.startsWith("http")?d:`${"/shopee-react/".replace(/\/$/,"")}${d}`;x.useEffect(()=>{window.scrollTo(0,0),(async()=>{if(t)try{let l=await fetch(`https://shopee-api-bbnl.onrender.com/dailySuggestions?id=${t}`),c=await l.json();if(c.length>0){const n=c[0];m({id:n.id,title:n.title,img:n.img,price:n.price,discount:n.discount,rating:4.9,sold:"1.2k"});return}if(l=await fetch(`https://shopee-api-bbnl.onrender.com/flashSaleProducts?id=${t}`),c=await l.json(),c.length>0){const n=c[0];m({id:String(n.id),title:"Sản phẩm Flash Sale",img:n.image,price:n.price,oldPrice:"200.000₫",discount:n.discount,rating:5,sold:n.soldLabel});return}if(l=await fetch(`https://shopee-api-bbnl.onrender.com/topSearches?id=${t}`),c=await l.json(),c.length>0){const n=c[0];m({id:String(n.id),title:n.label,img:n.img,price:"Liên hệ",rating:4.5,sold:n.sold});return}if(l=await fetch(`https://shopee-api-bbnl.onrender.com/shopeeMallProducts?id=${t}`),c=await l.json(),c.length>0){const n=c[0];m({id:String(n.id),title:"Sản phẩm Shopee Mall",img:n.img,price:"Liên hệ",rating:5,sold:"500+"});return}}catch(l){console.error("Lỗi khi tìm sản phẩm:",l)}})()},[t]);const b=Qe({mutationFn:async d=>{if(!i)return;const l="shop1",c=await fetch(`https://shopee-api-bbnl.onrender.com/cart/${l}`);if(!c.ok)throw new Error("Không tìm thấy shop");const n=await c.json(),j={id:i.id,name:i.title,image:i.img,variant:"Phân Loại: Mặc định",oldPrice:i.oldPrice||i.price,newPrice:i.price,quantity:y},A=n.products.findIndex(u=>u.id===j.id),S=[...n.products];return A>-1?S[A].quantity+=y:S.push(j),await fetch(`https://shopee-api-bbnl.onrender.com/cart/${l}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({products:S})}),d},onSuccess:d=>{a.invalidateQueries({queryKey:["cart"]}),d==="add"?M(!0):o("/cart")},onError:d=>{alert("Lỗi khi thêm vào giỏ: "+d)}}),p=()=>b.mutate("add"),V=()=>b.mutate("buy");return i?e.jsxs(P,{sx:{bgcolor:"#f5f5f5",py:3,minHeight:"80vh"},children:[e.jsxs(De,{maxWidth:"lg",children:[e.jsx(ue,{elevation:1,sx:{p:3},children:e.jsxs(ne,{container:!0,spacing:4,children:[e.jsx(ne,{size:{xs:12,md:5},children:e.jsx(P,{component:"img",src:E(i.img),sx:{width:"100%",aspectRatio:"1/1",objectFit:"cover",border:"1px solid #f0f0f0",borderRadius:"2px"}})}),e.jsxs(ne,{size:{xs:12,md:7},children:[e.jsx(h,{variant:"h6",component:"h1",sx:{fontWeight:500,mb:2},children:i.title}),e.jsxs(P,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[e.jsxs(P,{sx:{display:"flex",color:"#ee4d2d",borderBottom:"1px solid #ee4d2d",cursor:"pointer"},children:[e.jsx(h,{sx:{mr:.5,fontWeight:"bold",textDecoration:"underline"},children:i.rating}),e.jsx(rt,{value:i.rating,precision:.1,size:"small",readOnly:!0,sx:{color:"#ee4d2d"}})]}),e.jsxs(h,{variant:"body2",color:"text.secondary",children:["| 1.2k Đánh giá | ",i.sold," Đã bán"]})]}),e.jsxs(P,{sx:{bgcolor:"#fafafa",p:2,mb:3,display:"flex",alignItems:"center",gap:2},children:[i.oldPrice&&e.jsx(h,{variant:"body1",sx:{textDecoration:"line-through",color:"text.secondary"},children:i.oldPrice}),e.jsx(h,{variant:"h4",sx:{color:"primary.main",fontWeight:500},children:i.price}),i.discount&&e.jsxs(h,{variant:"caption",sx:{bgcolor:"primary.main",color:"white",px:1,borderRadius:"2px",fontWeight:"bold"},children:[i.discount," GIẢM"]})]}),e.jsxs(P,{sx:{mb:3,display:"flex",gap:2},children:[e.jsx(h,{color:"text.secondary",sx:{width:100},children:"Vận Chuyển"}),e.jsx(h,{children:"Miễn phí vận chuyển"})]}),e.jsxs(P,{sx:{display:"flex",alignItems:"center",gap:2,mb:4},children:[e.jsx(h,{color:"text.secondary",sx:{width:100},children:"Số Lượng"}),e.jsx(Ue,{value:y,onChange:F}),e.jsx(h,{color:"text.secondary",variant:"caption",children:"100 sản phẩm có sẵn"})]}),e.jsxs(P,{sx:{display:"flex",gap:2},children:[e.jsx(pe,{variant:"outlined",size:"large",startIcon:e.jsx(lt,{}),sx:{borderColor:"primary.main",color:"primary.main",bgcolor:"rgba(238, 77, 45, 0.08)",px:3,height:48,"&:hover":{bgcolor:"rgba(238, 77, 45, 0.12)",borderColor:"primary.main"}},onClick:p,children:"Thêm Vào Giỏ Hàng"}),e.jsx(pe,{variant:"contained",size:"large",sx:{bgcolor:"primary.main",color:"white",px:5,height:48,"&:hover":{bgcolor:"#d73211"}},onClick:V,children:"Mua Ngay"})]})]})]})}),e.jsxs(ue,{elevation:1,sx:{p:3,mt:2},children:[e.jsx(h,{variant:"h6",sx:{bgcolor:"#f5f5f5",p:2,mb:2},children:"MÔ TẢ SẢN PHẨM"}),e.jsxs(h,{variant:"body2",sx:{whiteSpace:"pre-line",lineHeight:1.8},children:["Sản phẩm chất lượng cao, chính hãng.",e.jsx("br",{}),"- Chất liệu: Cao cấp",e.jsx("br",{}),"- Xuất xứ: Việt Nam",e.jsx("br",{}),"- Bảo hành: 12 tháng",e.jsx("br",{}),"Mua ngay để nhận ưu đãi hấp dẫn!"]})]})]}),e.jsx(qe,{open:v,autoHideDuration:2e3,onClose:()=>M(!1),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(We,{severity:"success",variant:"filled",sx:{width:"100%"},children:"Sản phẩm đã được thêm vào Giỏ hàng"})})]}):e.jsx(P,{sx:{p:5,textAlign:"center"},children:"Đang tải hoặc không tìm thấy sản phẩm..."})}export{gt as default};
