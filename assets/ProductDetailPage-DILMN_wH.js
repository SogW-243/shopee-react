import{t as se,j as e,a as He,g as Le,r as x,u as ze,J as me,b as Ee,K as Ie,z as G,s as J,c as K,d as ge,e as Te,m as fe,M as Ne,N as de,O as $e,Q as ke,v as Oe,x as Be,B as w,C as De,P as ue,G as ne,T as h,w as pe,A as We}from"./index-DNP_ltZ0.js";import{u as Qe}from"./useMutation-DTnRT8M7.js";import{Q as Ge}from"./QuantityInput-cqbGvYE1.js";import{u as qe}from"./TextField-Ba6QDI2k.js";import{S as Ue}from"./Snackbar-CotDIw30.js";import"./Grow-BavFjpne.js";const Xe={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},Ke=se(e.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})),Je=se(e.jsx("path",{d:"M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"}));function Ye(t){return Le("MuiRating",t)}const Q=He("MuiRating",["root","sizeSmall","sizeMedium","sizeLarge","readOnly","disabled","focusVisible","visuallyHidden","pristine","label","labelEmptyValueActive","icon","iconEmpty","iconFilled","iconHover","iconFocus","iconActive","decimal"]);function _e(t){const o=t.toString().split(".")[1];return o?o.length:0}function ie(t,o){if(t==null)return t;const a=Math.round(t/o)*o;return Number(a.toFixed(_e(o)))}const Ze=t=>{const{classes:o,size:a,readOnly:n,disabled:m,emptyValueFocused:y,focusVisible:P}=t,v={root:["root",`size${ge(a)}`,m&&"disabled",P&&"focusVisible",n&&"readOnly"],label:["label","pristine"],labelEmptyValue:[y&&"labelEmptyValueActive"],icon:["icon"],iconEmpty:["iconEmpty"],iconFilled:["iconFilled"],iconHover:["iconHover"],iconFocus:["iconFocus"],iconActive:["iconActive"],decimal:["decimal"],visuallyHidden:["visuallyHidden"]};return Te(v,Ye,o)},et=J("span",{name:"MuiRating",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:a}=t;return[{[`& .${Q.visuallyHidden}`]:o.visuallyHidden},o.root,o[`size${ge(a.size)}`],a.readOnly&&o.readOnly]}})(fe(({theme:t})=>({display:"inline-flex",position:"relative",fontSize:t.typography.pxToRem(24),color:"#faaf00",cursor:"pointer",textAlign:"left",width:"min-content",WebkitTapHighlightColor:"transparent",[`&.${Q.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${Q.focusVisible} .${Q.iconActive}`]:{outline:"1px solid #999"},[`& .${Q.visuallyHidden}`]:Xe,variants:[{props:{size:"small"},style:{fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{fontSize:t.typography.pxToRem(30)}},{props:({ownerState:o})=>o.readOnly,style:{pointerEvents:"none"}}]}))),xe=J("label",{name:"MuiRating",slot:"Label",overridesResolver:({ownerState:t},o)=>[o.label,t.emptyValueFocused&&o.labelEmptyValueActive]})({cursor:"inherit",variants:[{props:({ownerState:t})=>t.emptyValueFocused,style:{top:0,bottom:0,position:"absolute",outline:"1px solid #999",width:"100%"}}]}),tt=J("span",{name:"MuiRating",slot:"Icon",overridesResolver:(t,o)=>{const{ownerState:a}=t;return[o.icon,a.iconEmpty&&o.iconEmpty,a.iconFilled&&o.iconFilled,a.iconHover&&o.iconHover,a.iconFocus&&o.iconFocus,a.iconActive&&o.iconActive]}})(fe(({theme:t})=>({display:"flex",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest}),pointerEvents:"none",variants:[{props:({ownerState:o})=>o.iconActive,style:{transform:"scale(1.2)"}},{props:({ownerState:o})=>o.iconEmpty,style:{color:(t.vars||t).palette.action.disabled}}]}))),ot=J("span",{name:"MuiRating",slot:"Decimal",shouldForwardProp:t=>Ne(t)&&t!=="iconActive",overridesResolver:(t,o)=>{const{iconActive:a}=t;return[o.decimal,a&&o.iconActive]}})({position:"relative",variants:[{props:({iconActive:t})=>t,style:{transform:"scale(1.2)"}}]});function nt(t){const{value:o,...a}=t;return e.jsx("span",{...a})}function he(t){const{classes:o,disabled:a,emptyIcon:n,focus:m,getLabelText:y,highlightSelectedOnly:P,hover:v,icon:V,IconContainerComponent:A,isActive:F,itemValue:u,labelProps:p,name:c,onBlur:l,onChange:i,onClick:b,onFocus:j,readOnly:C,ownerState:H,ratingValue:d,ratingValueRounded:L,slots:Y={},slotProps:_={}}=t,z=P?u===d:u<=d,O=u<=v,q=u<=m,B=u===L,U=`${c}-${me()}`,D={slots:Y,slotProps:_},[I,Z]=G("icon",{elementType:tt,className:K(o.icon,z?o.iconFilled:o.iconEmpty,O&&o.iconHover,q&&o.iconFocus,F&&o.iconActive),externalForwardedProps:D,ownerState:{...H,iconEmpty:!z,iconFilled:z,iconHover:O,iconFocus:q,iconActive:F},additionalProps:{value:u},internalForwardedProps:{as:A}}),[g,T]=G("label",{elementType:xe,externalForwardedProps:D,ownerState:{...H,emptyValueFocused:void 0},additionalProps:{style:p?.style,htmlFor:U}}),R=e.jsx(I,{...Z,children:n&&!z?n:V});return C?e.jsx("span",{...p,children:R}):e.jsxs(x.Fragment,{children:[e.jsxs(g,{...T,children:[R,e.jsx("span",{className:o.visuallyHidden,children:y(u)})]}),e.jsx("input",{className:o.visuallyHidden,onFocus:j,onBlur:l,onChange:i,onClick:b,disabled:a,value:u,id:U,type:"radio",name:c,checked:B})]})}const it=e.jsx(Ke,{fontSize:"inherit"}),st=e.jsx(Je,{fontSize:"inherit"});function at(t){return`${t||"0"} Star${t!==1?"s":""}`}const rt=x.forwardRef(function(o,a){const n=ze({name:"MuiRating",props:o}),{component:m="span",className:y,defaultValue:P=null,disabled:v=!1,emptyIcon:V=st,emptyLabelText:A="Empty",getLabelText:F=at,highlightSelectedOnly:u=!1,icon:p=it,IconContainerComponent:c=nt,max:l=5,name:i,onChange:b,onChangeActive:j,onMouseLeave:C,onMouseMove:H,precision:d=1,readOnly:L=!1,size:Y="medium",value:_,slots:z={},slotProps:O={},...q}=n,B=me(i),[U,D]=qe({controlled:_,default:P,name:"Rating"}),I=ie(U,d),Z=Ee(),[{hover:g,focus:T},R]=x.useState({hover:-1,focus:-1});let N=I;g!==-1&&(N=g),T!==-1&&(N=T);const[ye,ee]=x.useState(!1),ae=x.useRef(),ve=Ie(ae,a),be=s=>{H&&H(s);const r=ae.current,{right:f,left:X,width:$}=r.getBoundingClientRect();let k;Z?k=(f-s.clientX)/$:k=(s.clientX-X)/$;let S=ie(l*k+d/2,d);S=$e(S,d,l),R(E=>E.hover===S&&E.focus===S?E:{hover:S,focus:S}),ee(!1),j&&g!==S&&j(s,S)},je=s=>{C&&C(s);const r=-1;R({hover:r,focus:r}),j&&g!==r&&j(s,r)},re=s=>{let r=s.target.value===""?null:parseFloat(s.target.value);g!==-1&&(r=g),D(r),b&&b(s,r)},Se=s=>{s.clientX===0&&s.clientY===0||(R({hover:-1,focus:-1}),D(null),b&&parseFloat(s.target.value)===I&&b(s,null))},we=s=>{de(s.target)&&ee(!0);const r=parseFloat(s.target.value);R(f=>({hover:f.hover,focus:r}))},Pe=s=>{if(g!==-1)return;de(s.target)||ee(!1);const r=-1;R(f=>({hover:f.hover,focus:r}))},[Fe,le]=x.useState(!1),W={...n,component:m,defaultValue:P,disabled:v,emptyIcon:V,emptyLabelText:A,emptyValueFocused:Fe,focusVisible:ye,getLabelText:F,icon:p,IconContainerComponent:c,max:l,precision:d,readOnly:L,size:Y},M=Ze(W),te={slots:z,slotProps:O},[Ce,Re]=G("root",{ref:ve,className:K(M.root,y),elementType:et,externalForwardedProps:{...te,...q,component:m},getSlotProps:s=>({...s,onMouseMove:r=>{be(r),s.onMouseMove?.(r)},onMouseLeave:r=>{je(r),s.onMouseLeave?.(r)}}),ownerState:W,additionalProps:{role:L?"img":null,"aria-label":L?F(N):null}}),[Me,Ve]=G("label",{className:K(M.label,M.labelEmptyValue),elementType:xe,externalForwardedProps:te,ownerState:W}),[Ae,ce]=G("decimal",{className:M.decimal,elementType:ot,externalForwardedProps:te,ownerState:W});return e.jsxs(Ce,{...Re,children:[Array.from(new Array(l)).map((s,r)=>{const f=r+1,X={classes:M,disabled:v,emptyIcon:V,focus:T,getLabelText:F,highlightSelectedOnly:u,hover:g,icon:p,IconContainerComponent:c,name:B,onBlur:Pe,onChange:re,onClick:Se,onFocus:we,ratingValue:N,ratingValueRounded:I,readOnly:L,ownerState:W,slots:z,slotProps:O},$=f===Math.ceil(N)&&(g!==-1||T!==-1);if(d<1){const k=Array.from(new Array(1/d));return x.createElement(Ae,{...ce,key:f,className:K(ce.className,$&&M.iconActive),iconActive:$},k.map((S,E)=>{const oe=ie(f-1+(E+1)*d,d);return e.jsx(he,{...X,isActive:!1,itemValue:oe,labelProps:{style:k.length-1===E?{}:{width:oe===N?`${(E+1)*d*100}%`:"0%",overflow:"hidden",position:"absolute"}}},oe)}))}return e.jsx(he,{...X,isActive:$,itemValue:f},f)}),!L&&!v&&e.jsxs(Me,{...Ve,children:[e.jsx("input",{className:M.visuallyHidden,value:"",id:`${B}-empty`,type:"radio",name:B,checked:I==null,onFocus:()=>le(!0),onBlur:()=>le(!1),onChange:re}),e.jsx("span",{className:M.visuallyHidden,children:A})]})]})}),lt=se(e.jsx("path",{d:"M11 9h2V6h3V4h-3V1h-2v3H8v2h3zm-4 9c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2m10 0c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2m-9.83-3.25.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.86-7.01L19.42 4h-.01l-1.1 2-2.76 5H8.53l-.13-.27L6.16 6l-.95-2-.94-2H1v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.13 0-.25-.11-.25-.25"}));function gt(){const{id:t}=ke(),o=Oe(),a=Be(),[n,m]=x.useState(null),[y,P]=x.useState(1),[v,V]=x.useState(!1);x.useEffect(()=>{window.scrollTo(0,0),(async()=>{if(t)try{let c=await fetch(`https://shopee-api-bbnl.onrender.com/dailySuggestions?id=${t}`),l=await c.json();if(l.length>0){const i=l[0];m({id:i.id,title:i.title,img:i.img,price:i.price,discount:i.discount,rating:4.9,sold:"1.2k"});return}if(c=await fetch(`https://shopee-api-bbnl.onrender.com/flashSaleProducts?id=${t}`),l=await c.json(),l.length>0){const i=l[0];m({id:String(i.id),title:"Sản phẩm Flash Sale",img:i.image,price:i.price,oldPrice:"200.000₫",discount:i.discount,rating:5,sold:i.soldLabel});return}if(c=await fetch(`https://shopee-api-bbnl.onrender.com/topSearches?id=${t}`),l=await c.json(),l.length>0){const i=l[0];m({id:String(i.id),title:i.label,img:i.img,price:"Liên hệ",rating:4.5,sold:i.sold});return}if(c=await fetch(`https://shopee-api-bbnl.onrender.com/shopeeMallProducts?id=${t}`),l=await c.json(),l.length>0){const i=l[0];m({id:String(i.id),title:"Sản phẩm Shopee Mall",img:i.img,price:"Liên hệ",rating:5,sold:"500+"});return}}catch(c){console.error("Lỗi khi tìm sản phẩm:",c)}})()},[t]);const A=Qe({mutationFn:async p=>{if(!n)return;const c="shop1",l=await fetch(`https://shopee-api-bbnl.onrender.com/cart/${c}`);if(!l.ok)throw new Error("Không tìm thấy shop");const i=await l.json(),b={id:n.id,name:n.title,image:n.img,variant:"Phân Loại: Mặc định",oldPrice:n.oldPrice||n.price,newPrice:n.price,quantity:y},j=i.products.findIndex(H=>H.id===b.id),C=[...i.products];return j>-1?C[j].quantity+=y:C.push(b),await fetch(`https://shopee-api-bbnl.onrender.com/cart/${c}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({products:C})}),p},onSuccess:p=>{a.invalidateQueries({queryKey:["cart"]}),p==="add"?V(!0):o("/cart")},onError:p=>{alert("Lỗi khi thêm vào giỏ: "+p)}}),F=()=>A.mutate("add"),u=()=>A.mutate("buy");return n?e.jsxs(w,{sx:{bgcolor:"#f5f5f5",py:3,minHeight:"80vh"},children:[e.jsxs(De,{maxWidth:"lg",children:[e.jsx(ue,{elevation:1,sx:{p:3},children:e.jsxs(ne,{container:!0,spacing:4,children:[e.jsx(ne,{size:{xs:12,md:5},children:e.jsx(w,{component:"img",src:n.img,sx:{width:"100%",aspectRatio:"1/1",objectFit:"cover",border:"1px solid #f0f0f0",borderRadius:"2px"}})}),e.jsxs(ne,{size:{xs:12,md:7},children:[e.jsx(h,{variant:"h6",component:"h1",sx:{fontWeight:500,mb:2},children:n.title}),e.jsxs(w,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[e.jsxs(w,{sx:{display:"flex",color:"#ee4d2d",borderBottom:"1px solid #ee4d2d",cursor:"pointer"},children:[e.jsx(h,{sx:{mr:.5,fontWeight:"bold",textDecoration:"underline"},children:n.rating}),e.jsx(rt,{value:n.rating,precision:.1,size:"small",readOnly:!0,sx:{color:"#ee4d2d"}})]}),e.jsxs(h,{variant:"body2",color:"text.secondary",children:["| 1.2k Đánh giá | ",n.sold," Đã bán"]})]}),e.jsxs(w,{sx:{bgcolor:"#fafafa",p:2,mb:3,display:"flex",alignItems:"center",gap:2},children:[n.oldPrice&&e.jsx(h,{variant:"body1",sx:{textDecoration:"line-through",color:"text.secondary"},children:n.oldPrice}),e.jsx(h,{variant:"h4",sx:{color:"primary.main",fontWeight:500},children:n.price}),n.discount&&e.jsxs(h,{variant:"caption",sx:{bgcolor:"primary.main",color:"white",px:1,borderRadius:"2px",fontWeight:"bold"},children:[n.discount," GIẢM"]})]}),e.jsxs(w,{sx:{mb:3,display:"flex",gap:2},children:[e.jsx(h,{color:"text.secondary",sx:{width:100},children:"Vận Chuyển"}),e.jsx(h,{children:"Miễn phí vận chuyển"})]}),e.jsxs(w,{sx:{display:"flex",alignItems:"center",gap:2,mb:4},children:[e.jsx(h,{color:"text.secondary",sx:{width:100},children:"Số Lượng"}),e.jsx(Ge,{value:y,onChange:P}),e.jsx(h,{color:"text.secondary",variant:"caption",children:"100 sản phẩm có sẵn"})]}),e.jsxs(w,{sx:{display:"flex",gap:2},children:[e.jsx(pe,{variant:"outlined",size:"large",startIcon:e.jsx(lt,{}),sx:{borderColor:"primary.main",color:"primary.main",bgcolor:"rgba(238, 77, 45, 0.08)",px:3,height:48,"&:hover":{bgcolor:"rgba(238, 77, 45, 0.12)",borderColor:"primary.main"}},onClick:F,children:"Thêm Vào Giỏ Hàng"}),e.jsx(pe,{variant:"contained",size:"large",sx:{bgcolor:"primary.main",color:"white",px:5,height:48,"&:hover":{bgcolor:"#d73211"}},onClick:u,children:"Mua Ngay"})]})]})]})}),e.jsxs(ue,{elevation:1,sx:{p:3,mt:2},children:[e.jsx(h,{variant:"h6",sx:{bgcolor:"#f5f5f5",p:2,mb:2},children:"MÔ TẢ SẢN PHẨM"}),e.jsxs(h,{variant:"body2",sx:{whiteSpace:"pre-line",lineHeight:1.8},children:["Sản phẩm chất lượng cao, chính hãng.",e.jsx("br",{}),"- Chất liệu: Cao cấp",e.jsx("br",{}),"- Xuất xứ: Việt Nam",e.jsx("br",{}),"- Bảo hành: 12 tháng",e.jsx("br",{}),"Mua ngay để nhận ưu đãi hấp dẫn!"]})]})]}),e.jsx(Ue,{open:v,autoHideDuration:2e3,onClose:()=>V(!1),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(We,{severity:"success",variant:"filled",sx:{width:"100%"},children:"Sản phẩm đã được thêm vào Giỏ hàng"})})]}):e.jsx(w,{sx:{p:5,textAlign:"center"},children:"Đang tải hoặc không tìm thấy sản phẩm..."})}export{gt as default};
